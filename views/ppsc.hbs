<div><a href="/">Home</a></div>
<h1>{{title}}</h1>
<div>Amount: <input type="text" id="input-amount" style="width:100px" value="300"></div>
<div class="loading" id="loading-button">Loading paypal button...</div>
<div id="paypal-button-container"></div>


<div id="paypal-result-container"></div>

{{!-- PP Rest API simple --}}
{{!-- client-id=Abf.. #App: MerchantAppUS | Account: eran.m.us@merchant.com (BusinessPro) --}}
<script
  src="https://www.paypal.com/sdk/js?client-id=AaLfG87rC4XN5QisWLhUw27uFUE0KypDXHNySFuya-jNbzKIE4s4a6Yu2q8ylFhMPgw3KflYRGc8Uhjz&currency=USD&commit=false&components=buttons">
  </script>

<script>
  var amountElement = $("#input-amount");
  var amount = amountElement.val();
  amountElement.change(function () {

    amount = amountElement.val();

    console.log(amount);
    loadButtons();

  });

  function loadButtons() {
    $("#loading-button").show();

    paypal.Buttons({

      // Sets up the transaction when a payment button is clicked
      createOrder: function (data, actions) {
        return actions.order.create({
          purchase_units: [{
           // description: "puchase unit description",
           // soft_descriptor: "my soft descriptor",
            /*items: [
            {name: "item 1", quantity:1},
            {name: "item 2", quantity:5}
            ],*/
            amount: {
              value: amount // Can reference variables or functions. Example: `value: document.getElementById('...').value`
            }
          }]
        });
      },

      // Finalize the transaction after payer approval
      onApprove: function (data, actions) {
        return actions.order.capture().then(function (orderData) {
          // Successful capture! For dev/demo purposes:
          let resultJson = JSON.stringify(orderData, null, 2);
          console.log('Capture result', orderData, resultJson);
          var transaction = orderData.purchase_units[0].payments.captures[0];
          // alert('Transaction ' + transaction.status + ': ' + transaction.id + '\n\nSee console for all available details');
          $('#paypal-result-container').text(`Capture Result: ${resultJson} | Transaction: ${JSON.stringify(transaction)} `);
          // When ready to go live, remove the alert and show a success message within this page. For example:
          // var element = document.getElementById('paypal-button-container');
          // element.innerHTML = '';
          // element.innerHTML = '<h3>Thank you for your payment!</h3>';
          // Or go to another URL:  actions.redirect('thank_you.html');
        }).catch(function (err) {
          console.log(err);
          $('#paypal-result-container').text(err);
        });
      }
    }).render('#paypal-button-container').then(function () {
      $("#loading-button").hide();

    });



  }

  loadButtons();




</script>