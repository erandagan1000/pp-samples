<div><a href="/">Home</a></div>
<h1>{{title}}</h1>
<form id="my-container" method="post"></form>

<script>
  window.paypalCheckoutReady = function () {
    // BVKWTJDWMSX48 -> accountId as it appears in PP developer portal -> account (business) details -> profile
    paypal.checkout.setup('BVKWTJDWMSX48', {
      environment: 'sandbox',
      locale: 'en_US',
      buttons: [{ container: 'my-container', type: 'checkout', color: 'gold' }],
      click: function (event) {
        event.preventDefault();
        paypal.checkout.initXO();
      
        $.support.cors = true;

        $.ajax({
          url: "/ppnvp/ec",  //setExpressCheckout
          type: "POST",
          data: undefined,  //'&ajax=1&onlytoken=1',
          async: true,
          crossDomain: true,

          //Load the minibrowser with the redirection url in the success handler
          success: function (token) {
            var url = paypal.checkout.urlPrefix + token;
            //Loading Mini browser with redirect url, true for async AJAX calls
            console.log("NVP Success Url:" + url);
            paypal.checkout.startFlow(url);
          },
          error: function (responseData, textStatus, errorThrown) {
            alert("Error in ajax post" + responseData.statusText);
            //Gracefully Close the minibrowser in case of AJAX errors
            paypal.checkout.closeFlow();
          }
        });
        
      }
    });
  };
</script>

<script src="https://www.paypalobjects.com/api/checkout.js" async></script>