<div><a href="/">Home</a></div>
<h1>{{title}}</h1>
<div id="paypal-button-container"></div>
<div id="paypal-result-container"></div>
{{!-- PP Rest API simple --}}
{{!-- script query parameters:  --}}
{{!-- currency=USD&debug=true&commit=false&enable-funding=venmo&vault=true --}}
{{!-- components=buttons,hosted-fields,marks,messages --}}
{{!-- client-id=Abf... #App: ACDC | Account: eran.m.us@merchant.com (BusinessPro) --}}
<script
  src="https://www.paypal.com/sdk/js?components=buttons&client-id=AbfWHDmsApd4IM7TDiLYpsjH28utsEt-XfxVOxnE9SKbtSziPLp_LhMToOKgVKjXR7BVhDw6Pvw89ALk">
  </script>

<script>

  paypal.Buttons({

    // Sets up the transaction when a payment button is clicked
    createOrder: function (data, actions) {
      return actions.order.create({
        purchase_units: [{
          amount: {
            value: '77.44' // Can reference variables or functions. Example: `value: document.getElementById('...').value`
          },
          shipping: {
            options: [
              {
                id: "SHIP_123",
                label: "Domestic Shipping",
                type: "SHIPPING",
                selected: true,
                amount: {
                  value: "3.00",
                  currency_code: "USD"
                }
              },
              {
                id: "SHIP_456",
                label: "International Shipping",
                type: "SHIPPING",
                selected: false,
                amount: {
                  value: "13.00",
                  currency_code: "USD"
                }
              },
              {
                id: "SHIP_789",
                label: "Pick up in Store",
                type: "PICKUP",
                selected: false,
                amount: {
                  value: "0.00",
                  currency_code: "USD"
                }
              }
            ]
          }
        }]
      });
    },

    // Finalize the transaction after payer approval
    onApprove: function (data, actions) {
      return actions.order.capture().then(function (orderData) {
        // Successful capture! For dev/demo purposes:
        let resultJson = JSON.stringify(orderData, null, 2);
        console.log('Capture result', orderData, resultJson);
        var transaction = orderData.purchase_units[0].payments.captures[0];
        alert('Transaction ' + transaction.status + ': ' + transaction.id + '\n\nSee console for all available details');
        $('#paypal-result-container').text(resultJson);
        // When ready to go live, remove the alert and show a success message within this page. For example:
        // var element = document.getElementById('paypal-button-container');
        // element.innerHTML = '';
        // element.innerHTML = '<h3>Thank you for your payment!</h3>';
        // Or go to another URL:  actions.redirect('thank_you.html');
      });
    },
    onShippingChange: function (data, actions) {
      console.log("SELECTED_OPTION", data.selected_shipping_option); // data.selected_shipping_option contains the selected shipping option
      // NOTE: data.selected_shipping_option_id contains the selected shipping ID
      // passed to the `actions.order.create()` call
      data.amount.value =
        parseFloat(baseAmount, 10) +
        parseFloat(data.selected_shipping_option.amount.value, 10);

      return actions.order.patch([
        {
          op: "replace",
          path: "/purchase_units/@reference_id=='default'/amount",
          value: { value: data.amount, currency_code: "USD" },
        },
      ]);

    }
  }).render('#paypal-button-container');


</script>